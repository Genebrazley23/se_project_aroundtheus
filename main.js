!function(){"use strict";var e=class{constructor(e,t){this._formSelector=e.formSelector,this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this.formEle=t,this._inputEles=[...this.formEle.querySelectorAll(this._inputSelector)],this._submitButton=this.formEle.querySelector(this._submitButtonSelector)}_showInputError(e){const t=this.formEle.querySelector(`#${e.id}-error`);t&&(t.textContent=e.validationMessage,t.classList.add(this._errorClass),e.classList.add(this._inputErrorClass))}_hideInputError(e){const t=this.formEle.querySelector(`#${e.id}-error`);t&&(t.textContent="",t.classList.remove(this._errorClass),e.classList.remove(this._inputErrorClass))}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}_toggleButtonState(){this._inputEles.some((e=>!e.validity.valid))?this.disableSubmit():this.enableSubmit()}_setEventListeners(){this._toggleButtonState(),this._inputEles.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState()}))}))}enableValidation(){this.formEle.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}disableSubmit(){this._submitButton.disabled=!0,this._submitButton.classList.add(this._inactiveButtonClass)}enableSubmit(){this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1}},t=class{constructor(e,t,s,i,r){let{name:n,link:o,_id:a,isLiked:l}=e;this._name=n,this._link=o,this._id=a,this._isLiked=l,this._cardSelector=t,this._cardImageClickHandler=s,this._handleDelete=i,this._handleCardLikeClick=r,this._cardElement=this._getTemplate(),this._likeButton=this._cardElement.querySelector(".card__like-button"),this._removeButton=this._cardElement.querySelector(".delete__button"),this._cardImageElement=this._cardElement.querySelector(".card__image"),this._setEventListeners(),this._bindInfo()}_getTemplate(){return document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0)}_bindInfo(){const e=this._cardElement.querySelector(".card__name");this._cardImageElement.src=this._link,this._cardImageElement.alt=this._name,e.textContent=this._name,this.updateLikeState()}updateLikeState(){const e="card__like-button_active";this._isLiked?this._likeButton.classList.add(e):this._likeButton.classList.remove(e)}_setEventListeners(){this._likeButton.addEventListener("click",(()=>{const e=this._isLiked;this._handleCardLikeClick(this._id,!e).then((()=>{this._isLiked=!e,this.updateLikeState()})).catch((e=>{console.error("Failed to toggle like:",e)}))})),this._removeButton.addEventListener("click",(()=>{this._handleDelete(this,this._cardElement)})),this._cardImageElement.addEventListener("click",this._cardImageClickHandler)}getView(){return this._cardElement}};class s{constructor(e){this._popElement=document.querySelector(e),this._popupCloseButton=this._popElement.querySelector(".modal__close"),this._handleModalClose=this._handleModalClose.bind(this),this._handleEscClose=this._handleEscClose.bind(this)}open(){this._popElement.classList.add("modal_open"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popElement.classList.remove("modal_open"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose(e){"Escape"===e.key&&this.close()}_handleModalClose(){this.close()}setEventListeners(){this._popElement.addEventListener("click",this._handleModalClose,!1),this._popupCloseButton.addEventListener("click",this._handleModalClose),this._popElement.querySelector(".modal__container").addEventListener("click",(e=>{e.stopPropagation()}))}}class i extends s{constructor(e,t){super(e),this._popupForm=this._popElement.querySelector(".modal__form"),this._inputList=this._popupForm.querySelectorAll(".modal__input"),this._handleFormSubmit=t,this._getInputValues=this._getInputValues.bind(this),this._submitButton=this._popupForm.querySelector(".modal__button"),this._submitButtonText=this._submitButton.textContent}_getInputValues(){const e={};return this._inputList.forEach((t=>{e[t.name]=t.value})),e}_clearInputs(){this._popupForm.reset()}renderLoading(e){console.log("fmer",e,this._submitButtonText),e?(this._submitButton.textContent="Saving...",this._submitButton.disabled=!0):(this._submitButton.textContent=this._submitButtonText,this._submitButton.disabled=!1)}setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",(e=>{e.preventDefault();const t=this._getInputValues();this.renderLoading(!0),this._handleFormSubmit(t).then((()=>{this._clearInputs(),this.close()})).catch((e=>{console.error(e)})).finally((()=>{this.renderLoading(!1)}))}))}setSubmitHandler(e){this._handleFormSubmit=e}}const r={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible"},n=document.querySelector(".profile__edit-button"),o=(document.querySelector(".profile__title"),document.querySelector("#profile__edit-modal")),a=(document.querySelector(".profile__description"),document.querySelector("#profile-title-input")),l=document.querySelector("#profile-description-input"),d=(document.querySelector("#image__popup"),document.forms.profile__form),c=(o.querySelector(".modal__close"),document.querySelector(".profile__add-button")),u=(document.querySelector(".cards__list"),document.forms["place__create-form"]),h=(document.querySelector("#place__create-modal").querySelector(".modal__close"),document.querySelector("#place__name-input"),document.querySelector("#place__image-link-input"),document.querySelector(".profile__avatar")),_=document.forms["avatar__update-form"],m=(document.querySelector("#avatar__image-link-input"),new class{constructor(e,t){let{renderer:s}=e;this._renderer=s,this._containerSelector=t,this._container=document.querySelector(this._containerSelector)}renderItems(){this._items.forEach((e=>{const t=this._renderer(e);this.addItem(t)}))}addItem(e){this._container.prepend(e)}setItems(e){this._items=e,this.renderItems()}}({renderer:k},".cards__list")),p=new class extends s{constructor(e){super(e),this._imageModalZoom=this._popElement.querySelector(".modal__zoom"),this._imageModalName=this._popElement.querySelector(".modal__name")}open(e){this._imageModalName.textContent=e.name,this._imageModalZoom.src=e.link,this._imageModalZoom.alt=e.name,super.open()}}("#image__popup");p.setEventListeners();const f=new class{constructor(e){let{profileTitleSelector:t,profileDescriptionSelector:s,avatarSelector:i}=e;this._profileTitle=document.querySelector(t),this._profileDescription=document.querySelector(s),this._avatar=document.querySelector(i)}getUserInfo(){return{title:this._profileTitle.textContent,description:this._profileDescription.textContent}}setUserInfo(e){let{title:t,description:s,avatar:i}=e;this._profileTitle.textContent=t,this._profileDescription.textContent=s,i&&(this._avatar.style.backgroundImage=`url(${i})`)}}({profileTitleSelector:".profile__title",profileDescriptionSelector:".profile__description",avatarSelector:".profile__avatar"}),b=new i("#profile__edit-modal",(function(e){return q.updateUserInfo({name:e.title,about:e.description}).then((()=>{f.setUserInfo(e)}))}));b.setEventListeners();const E=new i("#place__create-modal",(function(e){const t={name:e.title,link:e.link};return q.createCard(t).then((e=>{const t=k(e);m.addItem(t),L.disableSubmit()}))}));E.setEventListeners();const S=new i("#avatar__update-modal",(function(e){let{link:t}=e;return q.updateAvatar({avatar:t}).then((e=>{v.disableSubmit(),f.setUserInfo({title:e.name,description:e.about,avatar:e.avatar})}))}));S.setEventListeners(),h.addEventListener("click",(()=>{S.open()}));const v=new e(r,_);v.enableValidation();const C=new class extends s{constructor(e,t){super(e),this._handleSubmit=t,this._button=this._popElement.querySelector(".modal__button")}setSubmitAction(e){this._handleSubmit=e}setEventListeners(){super.setEventListeners(),this._button.addEventListener("click",(e=>{e.preventDefault(),this._handleSubmit()}))}}("#place__delete-modal");C.setEventListeners();const y=new e(r,d),L=new e(r,u);function g(e,t){return t?q.likeCard(e):q.unlikeCard(e)}function k(e){return new t(e,"#card__template",(function(){!function(e,t){const s={name:t,link:e};p.open(s)}(e.link,e.name)}),I,g).getView()}function I(e,t){C.open(),C.setSubmitAction((()=>q.deleteCard(e._id).then((()=>{t.remove(),C.close()})).catch((e=>{console.err(`Error deleting card: ${e}`)}))))}y.enableValidation(),L.enableValidation(),n.addEventListener("click",(function(){const e=f.getUserInfo();a.value=e.title,l.value=e.description,b.open()})),c.addEventListener("click",(function(){E.open()}));const q=new class{constructor(e){let{headers:t,baseUrl:s}=e;this._defaultHeaders=t,this._baseUrl=s}getInitialCards(){return this.handleResponse(fetch(this._baseUrl+"/cards",{headers:this._defaultHeaders}))}getUserInfo(){return this.handleResponse(fetch(this._baseUrl+"/users/me",{headers:this._defaultHeaders}))}updateUserInfo(e){return this.handleResponse(fetch(this._baseUrl+"/users/me",{method:"PATCH",headers:this._defaultHeaders,body:JSON.stringify(e)}))}createCard(e){return this.handleResponse(fetch(this._baseUrl+"/cards",{method:"POST",headers:this._defaultHeaders,body:JSON.stringify(e)}))}deleteCard(e){return this.handleResponse(fetch(this._baseUrl+"/cards/"+e,{method:"DELETE",headers:this._defaultHeaders}))}likeCard(e){return this.handleResponse(fetch(this._baseUrl+"/cards/"+e+"/likes",{method:"PUT",headers:this._defaultHeaders}))}unlikeCard(e){return this.handleResponse(fetch(this._baseUrl+"/cards/"+e+"/likes",{method:"DELETE",headers:this._defaultHeaders}))}updateAvatar(e){return this.handleResponse(fetch(this._baseUrl+"/users/me/avatar",{method:"PATCH",headers:this._defaultHeaders,body:JSON.stringify(e)}))}handleResponse(e){return e.then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))).catch((e=>{throw console.error(e),e}))}loadAll(){return Promise.all(this.getInitialCards(),this.getUserInfo())}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"93b64164-7992-45be-bad2-1f9098f0ec32","Content-Type":"application/json"}});q.getUserInfo().then((e=>{f.setUserInfo({title:e.name,description:e.about,avatar:e.avatar})})).catch((e=>{console.error("Error fetching user info:",e)})),q.getInitialCards().then((e=>{m.setItems(e)})).catch((e=>{console.error("Error fetching initial cards:",e)}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LFFBQVFJLElBQUk1TSxLQUFLNkwsa0JBQW1CN0wsS0FBS3FKLGNBQ2xELEdMaUdrQixDQUNsQnFDLFFBQVMsa0RBQ1RELFFBQVMsQ0FDUG9CLGNBQWUsdUNBQ2YsZUFBZ0Isc0JBSXBCL0MsRUFDR1QsY0FDQTdFLE1BQU1nSCxJQUNMMUMsRUFBU1UsWUFBWSxDQUNuQkYsTUFBT2tDLEVBQVMxSSxLQUNoQnlHLFlBQWFpQyxFQUFTeEIsTUFDdEJOLE9BQVE4QixFQUFTOUIsUUFDakIsSUFFSGpGLE9BQU9DLElBQ05DLFFBQVFDLE1BQU0sNEJBQTZCRixFQUFJLElBR25Eb0YsRUFDRytCLGtCQUNBckgsTUFBTXNJLElBQ0xuRixFQUFZWSxTQUFTdUUsRUFBTSxJQUU1QnJJLE9BQU9DLElBQ05DLFFBQVFDLE1BQU0sZ0NBQWlDRixFQUFJLEciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9DYXJkLmpzIiwid2VicGFjazovL2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvUG9wdXAuanMiLCJ3ZWJwYWNrOi8vYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL2Fyb3VuZHRoZXVzLy4vc3JjL3V0aWxzL2NvbnN0YW50cy5qcyIsIndlYnBhY2s6Ly9hcm91bmR0aGV1cy8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyIsIndlYnBhY2s6Ly9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIiwid2VicGFjazovL2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoQ29uZmlybS5qcyIsIndlYnBhY2s6Ly9hcm91bmR0aGV1cy8uL3NyYy91dGlscy9BcGkuanMiXSwic291cmNlc0NvbnRlbnQiOlsiY2xhc3MgRm9ybVZhbGlkYXRvciB7XG4gIGNvbnN0cnVjdG9yKGNvbmZpZywgZm9ybUVsZSkge1xuICAgIHRoaXMuX2Zvcm1TZWxlY3RvciA9IGNvbmZpZy5mb3JtU2VsZWN0b3I7XG4gICAgdGhpcy5faW5wdXRTZWxlY3RvciA9IGNvbmZpZy5pbnB1dFNlbGVjdG9yO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yID0gY29uZmlnLnN1Ym1pdEJ1dHRvblNlbGVjdG9yO1xuICAgIHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MgPSBjb25maWcuaW5hY3RpdmVCdXR0b25DbGFzcztcbiAgICB0aGlzLl9pbnB1dEVycm9yQ2xhc3MgPSBjb25maWcuaW5wdXRFcnJvckNsYXNzO1xuICAgIHRoaXMuX2Vycm9yQ2xhc3MgPSBjb25maWcuZXJyb3JDbGFzcztcblxuICAgIHRoaXMuZm9ybUVsZSA9IGZvcm1FbGU7XG4gICAgdGhpcy5faW5wdXRFbGVzID0gWy4uLnRoaXMuZm9ybUVsZS5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX2lucHV0U2VsZWN0b3IpXTtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSB0aGlzLmZvcm1FbGUucXVlcnlTZWxlY3Rvcih0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3Rvcik7XG4gIH1cblxuICBfc2hvd0lucHV0RXJyb3IoaW5wdXRFbGUpIHtcbiAgICBjb25zdCBlcnJvck1lc3NhZ2VFbGUgPSB0aGlzLmZvcm1FbGUucXVlcnlTZWxlY3RvcihgIyR7aW5wdXRFbGUuaWR9LWVycm9yYCk7XG4gICAgaWYgKGVycm9yTWVzc2FnZUVsZSkge1xuICAgICAgZXJyb3JNZXNzYWdlRWxlLnRleHRDb250ZW50ID0gaW5wdXRFbGUudmFsaWRhdGlvbk1lc3NhZ2U7XG4gICAgICBlcnJvck1lc3NhZ2VFbGUuY2xhc3NMaXN0LmFkZCh0aGlzLl9lcnJvckNsYXNzKTtcbiAgICAgIGlucHV0RWxlLmNsYXNzTGlzdC5hZGQodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcbiAgICB9XG4gIH1cblxuICBfaGlkZUlucHV0RXJyb3IoaW5wdXRFbGUpIHtcbiAgICBjb25zdCBlcnJvck1lc3NhZ2VFbGUgPSB0aGlzLmZvcm1FbGUucXVlcnlTZWxlY3RvcihgIyR7aW5wdXRFbGUuaWR9LWVycm9yYCk7XG4gICAgaWYgKGVycm9yTWVzc2FnZUVsZSkge1xuICAgICAgZXJyb3JNZXNzYWdlRWxlLnRleHRDb250ZW50ID0gXCJcIjtcbiAgICAgIGVycm9yTWVzc2FnZUVsZS5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2Vycm9yQ2xhc3MpO1xuICAgICAgaW5wdXRFbGUuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xuICAgIH1cbiAgfVxuXG4gIF9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGUpIHtcbiAgICBpZiAoIWlucHV0RWxlLnZhbGlkaXR5LnZhbGlkKSB7XG4gICAgICB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dEVsZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlKTtcbiAgICB9XG4gIH1cblxuICBfdG9nZ2xlQnV0dG9uU3RhdGUoKSB7XG4gICAgY29uc3QgZm91bmRJbnZhbGlkID0gdGhpcy5faW5wdXRFbGVzLnNvbWUoXG4gICAgICAoaW5wdXRFbGUpID0+ICFpbnB1dEVsZS52YWxpZGl0eS52YWxpZFxuICAgICk7XG5cbiAgICBpZiAoZm91bmRJbnZhbGlkKSB7XG4gICAgICB0aGlzLmRpc2FibGVTdWJtaXQoKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5lbmFibGVTdWJtaXQoKTtcbiAgICB9XG4gIH1cblxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcbiAgICB0aGlzLl9pbnB1dEVsZXMuZm9yRWFjaCgoaW5wdXRFbGUpID0+IHtcbiAgICAgIGlucHV0RWxlLmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoKSA9PiB7XG4gICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZSk7XG4gICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxuXG4gIGVuYWJsZVZhbGlkYXRpb24oKSB7XG4gICAgdGhpcy5mb3JtRWxlLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGUpID0+IHtcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICB9KTtcblxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG4gIH1cblxuICBkaXNhYmxlU3VibWl0KCkge1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IHRydWU7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5hZGQodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gIH1cblxuICBlbmFibGVTdWJtaXQoKSB7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmRpc2FibGVkID0gZmFsc2U7XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgRm9ybVZhbGlkYXRvcjtcbiIsImNsYXNzIENhcmQge1xuICBjb25zdHJ1Y3RvcihcbiAgICB7IG5hbWUsIGxpbmssIF9pZCwgaXNMaWtlZCB9LFxuICAgIGNhcmRTZWxlY3RvcixcbiAgICBjYXJkSW1hZ2VDbGlja0hhbmRsZXIsXG4gICAgaGFuZGxlRGVsZXRlLFxuICAgIGNhcmRMaWtlQ2xpY2tcbiAgKSB7XG4gICAgdGhpcy5fbmFtZSA9IG5hbWU7XG4gICAgdGhpcy5fbGluayA9IGxpbms7XG4gICAgdGhpcy5faWQgPSBfaWQ7XG4gICAgdGhpcy5faXNMaWtlZCA9IGlzTGlrZWQ7XG5cbiAgICB0aGlzLl9jYXJkU2VsZWN0b3IgPSBjYXJkU2VsZWN0b3I7XG4gICAgdGhpcy5fY2FyZEltYWdlQ2xpY2tIYW5kbGVyID0gY2FyZEltYWdlQ2xpY2tIYW5kbGVyO1xuICAgIHRoaXMuX2hhbmRsZURlbGV0ZSA9IGhhbmRsZURlbGV0ZTtcbiAgICB0aGlzLl9oYW5kbGVDYXJkTGlrZUNsaWNrID0gY2FyZExpa2VDbGljaztcblxuICAgIHRoaXMuX2NhcmRFbGVtZW50ID0gdGhpcy5fZ2V0VGVtcGxhdGUoKTtcbiAgICB0aGlzLl9saWtlQnV0dG9uID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlLWJ1dHRvblwiKTtcbiAgICB0aGlzLl9yZW1vdmVCdXR0b24gPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmRlbGV0ZV9fYnV0dG9uXCIpO1xuICAgIHRoaXMuX2NhcmRJbWFnZUVsZW1lbnQgPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlXCIpO1xuXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgICB0aGlzLl9iaW5kSW5mbygpO1xuICB9XG5cbiAgX2dldFRlbXBsYXRlKCkge1xuICAgIGNvbnN0IGNhcmRUZW1wbGF0ZSA9IGRvY3VtZW50XG4gICAgICAucXVlcnlTZWxlY3Rvcih0aGlzLl9jYXJkU2VsZWN0b3IpXG4gICAgICAuY29udGVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRcIik7XG4gICAgcmV0dXJuIGNhcmRUZW1wbGF0ZS5jbG9uZU5vZGUodHJ1ZSk7XG4gIH1cblxuICBfYmluZEluZm8oKSB7XG4gICAgY29uc3QgY2FyZFRpdGxlRWxlbWVudCA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbmFtZVwiKTtcbiAgICB0aGlzLl9jYXJkSW1hZ2VFbGVtZW50LnNyYyA9IHRoaXMuX2xpbms7XG4gICAgdGhpcy5fY2FyZEltYWdlRWxlbWVudC5hbHQgPSB0aGlzLl9uYW1lO1xuICAgIGNhcmRUaXRsZUVsZW1lbnQudGV4dENvbnRlbnQgPSB0aGlzLl9uYW1lO1xuICAgIHRoaXMudXBkYXRlTGlrZVN0YXRlKCk7XG4gIH1cblxuICB1cGRhdGVMaWtlU3RhdGUoKSB7XG4gICAgY29uc3QgYWN0aXZlQ2xhc3MgPSBcImNhcmRfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiO1xuICAgIGlmICh0aGlzLl9pc0xpa2VkKSB7XG4gICAgICB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC5hZGQoYWN0aXZlQ2xhc3MpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoYWN0aXZlQ2xhc3MpO1xuICAgIH1cbiAgfVxuXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9saWtlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICBjb25zdCBpc0N1cnJlbnRseUxpa2VkID0gdGhpcy5faXNMaWtlZDtcblxuICAgICAgdGhpcy5faGFuZGxlQ2FyZExpa2VDbGljayh0aGlzLl9pZCwgIWlzQ3VycmVudGx5TGlrZWQpXG4gICAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgICB0aGlzLl9pc0xpa2VkID0gIWlzQ3VycmVudGx5TGlrZWQ7XG4gICAgICAgICAgdGhpcy51cGRhdGVMaWtlU3RhdGUoKTtcbiAgICAgICAgfSlcbiAgICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgICBjb25zb2xlLmVycm9yKFwiRmFpbGVkIHRvIHRvZ2dsZSBsaWtlOlwiLCBlcnIpO1xuICAgICAgICB9KTtcbiAgICB9KTtcblxuICAgIC8vIERlbGV0ZSBCdXR0b24gRXZlbnQgTGlzdGVuZXJcbiAgICB0aGlzLl9yZW1vdmVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgIHRoaXMuX2hhbmRsZURlbGV0ZSh0aGlzLCB0aGlzLl9jYXJkRWxlbWVudCk7XG4gICAgfSk7XG5cbiAgICB0aGlzLl9jYXJkSW1hZ2VFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXG4gICAgICBcImNsaWNrXCIsXG4gICAgICB0aGlzLl9jYXJkSW1hZ2VDbGlja0hhbmRsZXJcbiAgICApO1xuICB9XG5cbiAgZ2V0VmlldygpIHtcbiAgICByZXR1cm4gdGhpcy5fY2FyZEVsZW1lbnQ7XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgQ2FyZDtcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xuICAgIHRoaXMuX3BvcEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHBvcHVwU2VsZWN0b3IpO1xuICAgIHRoaXMuX3BvcHVwQ2xvc2VCdXR0b24gPSB0aGlzLl9wb3BFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Nsb3NlXCIpO1xuICAgIHRoaXMuX2hhbmRsZU1vZGFsQ2xvc2UgPSB0aGlzLl9oYW5kbGVNb2RhbENsb3NlLmJpbmQodGhpcyk7XG4gICAgdGhpcy5faGFuZGxlRXNjQ2xvc2UgPSB0aGlzLl9oYW5kbGVFc2NDbG9zZS5iaW5kKHRoaXMpO1xuICB9XG5cbiAgb3BlbigpIHtcbiAgICB0aGlzLl9wb3BFbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJtb2RhbF9vcGVuXCIpO1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcbiAgfVxuXG4gIGNsb3NlKCkge1xuICAgIHRoaXMuX3BvcEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShcIm1vZGFsX29wZW5cIik7XG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xuICB9XG5cbiAgX2hhbmRsZUVzY0Nsb3NlKGV2dCkge1xuICAgIGlmIChldnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XG4gICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfVxuICB9XG5cbiAgX2hhbmRsZU1vZGFsQ2xvc2UoKSB7XG4gICAgdGhpcy5jbG9zZSgpO1xuICB9XG5cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fcG9wRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy5faGFuZGxlTW9kYWxDbG9zZSwgZmFsc2UpO1xuICAgIHRoaXMuX3BvcHVwQ2xvc2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHRoaXMuX2hhbmRsZU1vZGFsQ2xvc2UpO1xuICAgIHRoaXMuX3BvcEVsZW1lbnRcbiAgICAgIC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jb250YWluZXJcIilcbiAgICAgIC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcbiAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgIH0pO1xuICB9XG59XG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3RvciwgaGFuZGxlRm9ybVN1Ym1pdCkge1xuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xuICAgIHRoaXMuX3BvcHVwRm9ybSA9IHRoaXMuX3BvcEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcbiAgICB0aGlzLl9pbnB1dExpc3QgPSB0aGlzLl9wb3B1cEZvcm0ucXVlcnlTZWxlY3RvckFsbChcIi5tb2RhbF9faW5wdXRcIik7XG4gICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCA9IGhhbmRsZUZvcm1TdWJtaXQ7XG4gICAgdGhpcy5fZ2V0SW5wdXRWYWx1ZXMgPSB0aGlzLl9nZXRJbnB1dFZhbHVlcy5iaW5kKHRoaXMpO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX3BvcHVwRm9ybS5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19idXR0b25cIik7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uVGV4dCA9IHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudDtcbiAgfVxuXG4gIF9nZXRJbnB1dFZhbHVlcygpIHtcbiAgICBjb25zdCBkYXRhID0ge307XG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0KSA9PiB7XG4gICAgICBkYXRhW2lucHV0Lm5hbWVdID0gaW5wdXQudmFsdWU7XG4gICAgfSk7XG4gICAgcmV0dXJuIGRhdGE7XG4gIH1cblxuICBfY2xlYXJJbnB1dHMoKSB7XG4gICAgdGhpcy5fcG9wdXBGb3JtLnJlc2V0KCk7XG4gIH1cblxuICByZW5kZXJMb2FkaW5nKGlzTG9hZGluZykge1xuICAgIGNvbnNvbGUubG9nKFwiZm1lclwiLCBpc0xvYWRpbmcsIHRoaXMuX3N1Ym1pdEJ1dHRvblRleHQpO1xuICAgIGlmIChpc0xvYWRpbmcpIHtcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IFwiU2F2aW5nLi4uXCI7XG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24uZGlzYWJsZWQgPSB0cnVlO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSB0aGlzLl9zdWJtaXRCdXR0b25UZXh0O1xuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLmRpc2FibGVkID0gZmFsc2U7XG4gICAgfVxuICB9XG5cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgICB0aGlzLl9wb3B1cEZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZlbnQpID0+IHtcbiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICBjb25zdCBkYXRhID0gdGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKTtcbiAgICAgIHRoaXMucmVuZGVyTG9hZGluZyh0cnVlKTtcbiAgICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQoZGF0YSlcbiAgICAgICAgLnRoZW4oKCkgPT4ge1xuICAgICAgICAgIHRoaXMuX2NsZWFySW5wdXRzKCk7XG4gICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICB9KVxuICAgICAgICAuY2F0Y2goKGVycm9yKSA9PiB7XG4gICAgICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7XG4gICAgICAgIH0pXG4gICAgICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgICAgICB0aGlzLnJlbmRlckxvYWRpbmcoZmFsc2UpO1xuICAgICAgICB9KTtcbiAgICB9KTtcbiAgfVxuXG4gIHNldFN1Ym1pdEhhbmRsZXIoaGFuZGxlcikge1xuICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQgPSBoYW5kbGVyO1xuICB9XG59XG4iLCJleHBvcnQgY29uc3QgaW5pdGlhbENhcmRzID0gW1xuICB7XG4gICAgbmFtZTogXCJZb3NlbWl0ZSBWYWxsZXlcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QveW9zZW1pdGUuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIkxha2UgTG91aXNlXCIsXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2xha2UtbG91aXNlLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJCYWxkIE1vdW50YWluc1wiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9iYWxkLW1vdW50YWlucy5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiTGF0ZW1hclwiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYXRlbWFyLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJWYW5vaXNlIE5hdGlvbmFsIFBhcmtcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvdmFub2lzZS5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiTGFnbyBkaSBCcmFpZXNcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvbGFnby5qcGdcIixcbiAgfSxcbl07XG5cbmV4cG9ydCBjb25zdCB2YWxpZGF0aW9uQ29uZmlnID0ge1xuICBmb3JtU2VsZWN0b3I6IFwiLm1vZGFsX19mb3JtXCIsXG4gIGlucHV0U2VsZWN0b3I6IFwiLm1vZGFsX19pbnB1dFwiLFxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIubW9kYWxfX2J1dHRvblwiLFxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcIm1vZGFsX19idXR0b25fZGlzYWJsZWRcIixcbiAgaW5wdXRFcnJvckNsYXNzOiBcIm1vZGFsX19pbnB1dF90eXBlX2Vycm9yXCIsXG4gIGVycm9yQ2xhc3M6IFwibW9kYWxfX2Vycm9yX3Zpc2libGVcIixcbn07XG4iLCJpbXBvcnQgRm9ybVZhbGlkYXRvciBmcm9tIFwiLi4vY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzXCI7XG5pbXBvcnQgQ2FyZCBmcm9tIFwiLi4vY29tcG9uZW50cy9DYXJkLmpzXCI7XG5pbXBvcnQgXCIuLi9wYWdlcy9pbmRleC5jc3NcIjtcbmltcG9ydCBQb3B1cFdpdGhJbWFnZSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qc1wiO1xuaW1wb3J0IFBvcHVwV2l0aEZvcm0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qc1wiO1xuaW1wb3J0IFVzZXJJbmZvIGZyb20gXCIuLi9jb21wb25lbnRzL1VzZXJJbmZvLmpzXCI7XG5pbXBvcnQgeyBpbml0aWFsQ2FyZHMsIHZhbGlkYXRpb25Db25maWcgfSBmcm9tIFwiLi4vdXRpbHMvY29uc3RhbnRzLmpzXCI7XG5pbXBvcnQgU2VjdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9TZWN0aW9uLmpzXCI7XG5pbXBvcnQgQXBpIGZyb20gXCIuLi91dGlscy9BcGkuanNcIjtcbmltcG9ydCBQb3B1cFdpdGhDb25maXJtIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aENvbmZpcm0uanNcIjtcblxuLyogRUxFTUVOVFMgKi9cblxuY29uc3QgcHJvZmlsZUVkaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2VkaXQtYnV0dG9uXCIpO1xuY29uc3QgcHJvZmlsZVRpdGxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX190aXRsZVwiKTtcbmNvbnN0IHByb2ZpbGVFZGl0TW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGVfX2VkaXQtbW9kYWxcIik7XG5jb25zdCBwcm9maWxlRGVzY3JpcHRpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2Rlc2NyaXB0aW9uXCIpO1xuY29uc3QgcHJvZmlsZVRpdGxlSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtdGl0bGUtaW5wdXRcIik7XG5jb25zdCBwcm9maWxlRGVzY3JpcHRpb25JbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gIFwiI3Byb2ZpbGUtZGVzY3JpcHRpb24taW5wdXRcIlxuKTtcblxuY29uc3Qgb3BlblBvcHVwQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNpbWFnZV9fcG9wdXBcIik7XG5jb25zdCBwcm9maWxlRWRpdEZvcm0gPSBkb2N1bWVudC5mb3Jtc1tcInByb2ZpbGVfX2Zvcm1cIl07XG5jb25zdCBwcm9maWxlTW9kYWxDbG9zZSA9IHByb2ZpbGVFZGl0TW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2xvc2VcIik7XG5jb25zdCBwcm9maWxlQWRkQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hZGQtYnV0dG9uXCIpO1xuXG5jb25zdCBjYXJkTGlzdEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRzX19saXN0XCIpO1xuXG5jb25zdCBwbGFjZUNyZWF0ZUZvcm0gPSBkb2N1bWVudC5mb3Jtc1tcInBsYWNlX19jcmVhdGUtZm9ybVwiXTtcbmNvbnN0IHBsYWNlQ3JlYXRlTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3BsYWNlX19jcmVhdGUtbW9kYWxcIik7XG5jb25zdCBwbGFjZUNyZWF0ZUNsb3NlID0gcGxhY2VDcmVhdGVNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jbG9zZVwiKTtcblxuY29uc3QgcGxhY2VOYW1lSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3BsYWNlX19uYW1lLWlucHV0XCIpO1xuY29uc3QgcGxhY2VJbWFnZUlucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwbGFjZV9faW1hZ2UtbGluay1pbnB1dFwiKTtcblxuY29uc3QgYXZhdGFyRWRpdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYXZhdGFyXCIpO1xuY29uc3QgdXBkYXRlQXZhdGFyRm9ybSA9IGRvY3VtZW50LmZvcm1zW1wiYXZhdGFyX191cGRhdGUtZm9ybVwiXTtcbmNvbnN0IGF2YXRhcklucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNhdmF0YXJfX2ltYWdlLWxpbmstaW5wdXRcIik7XG5cbmNvbnN0IGNhcmRTZWN0aW9uID0gbmV3IFNlY3Rpb24oeyByZW5kZXJlcjogY3JlYXRlQ2FyZCB9LCBcIi5jYXJkc19fbGlzdFwiKTtcblxuY29uc3QgcG9wdXBXaXRoSW1hZ2UgPSBuZXcgUG9wdXBXaXRoSW1hZ2UoXCIjaW1hZ2VfX3BvcHVwXCIpO1xucG9wdXBXaXRoSW1hZ2Uuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuY29uc3QgdXNlckluZm8gPSBuZXcgVXNlckluZm8oe1xuICBwcm9maWxlVGl0bGVTZWxlY3RvcjogXCIucHJvZmlsZV9fdGl0bGVcIixcbiAgcHJvZmlsZURlc2NyaXB0aW9uU2VsZWN0b3I6IFwiLnByb2ZpbGVfX2Rlc2NyaXB0aW9uXCIsXG4gIGF2YXRhclNlbGVjdG9yOiBcIi5wcm9maWxlX19hdmF0YXJcIixcbn0pO1xuXG5jb25zdCBwcm9maWxlRWRpdFBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oXG4gIFwiI3Byb2ZpbGVfX2VkaXQtbW9kYWxcIixcbiAgaGFuZGxlRWRpdEZvcm1TdWJtaXRcbik7XG5cbnByb2ZpbGVFZGl0UG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuY29uc3QgcGxhY2VDcmVhdGVQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFxuICBcIiNwbGFjZV9fY3JlYXRlLW1vZGFsXCIsXG4gIGhhbmRsZVBsYWNlQ3JlYXRlRm9ybVxuKTtcblxucGxhY2VDcmVhdGVQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xuXG5jb25zdCBzZXRBdmF0YXJQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFxuICBcIiNhdmF0YXJfX3VwZGF0ZS1tb2RhbFwiLFxuICBoYW5kbGVBdmF0YXJVcGRhdGVcbik7XG5cbnNldEF2YXRhclBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbmF2YXRhckVkaXRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgc2V0QXZhdGFyUG9wdXAub3BlbigpO1xufSk7XG5cbi8vIGZpbmQgYXZhdGFyIGltYWdlIGVsZW1lbnQgYW5kIGFkZCBhIGNsaWNrIGhhbmRsZXIgdG8gb3BlbiB0aGUgdXBkYXRlIGZvcm0uXG4vL1xuY29uc3QgdXBkYXRlQXZhdGFyRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKFxuICB2YWxpZGF0aW9uQ29uZmlnLFxuICB1cGRhdGVBdmF0YXJGb3JtXG4pO1xudXBkYXRlQXZhdGFyRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG5cbmNvbnN0IHBvcHVwV2l0aENvbmZpcm0gPSBuZXcgUG9wdXBXaXRoQ29uZmlybShcIiNwbGFjZV9fZGVsZXRlLW1vZGFsXCIpO1xucG9wdXBXaXRoQ29uZmlybS5zZXRFdmVudExpc3RlbmVycygpO1xuXG5jb25zdCBwcm9maWxlRWRpdEZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihcbiAgdmFsaWRhdGlvbkNvbmZpZyxcbiAgcHJvZmlsZUVkaXRGb3JtXG4pO1xuXG5jb25zdCBwbGFjZUNyZWF0ZUZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihcbiAgdmFsaWRhdGlvbkNvbmZpZyxcbiAgcGxhY2VDcmVhdGVGb3JtXG4pO1xucHJvZmlsZUVkaXRGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcbnBsYWNlQ3JlYXRlRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG5cbi8qIExJU1RFTkVSUyAqL1xucHJvZmlsZUVkaXRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uICgpIHtcbiAgY29uc3QgdXNlckRhdGEgPSB1c2VySW5mby5nZXRVc2VySW5mbygpO1xuICBwcm9maWxlVGl0bGVJbnB1dC52YWx1ZSA9IHVzZXJEYXRhLnRpdGxlO1xuICBwcm9maWxlRGVzY3JpcHRpb25JbnB1dC52YWx1ZSA9IHVzZXJEYXRhLmRlc2NyaXB0aW9uO1xuICBwcm9maWxlRWRpdFBvcHVwLm9wZW4oKTtcbn0pO1xuXG5mdW5jdGlvbiBoYW5kbGVFZGl0Rm9ybVN1Ym1pdChkYXRhKSB7XG4gIHJldHVybiBhcGlcbiAgICAudXBkYXRlVXNlckluZm8oeyBuYW1lOiBkYXRhLnRpdGxlLCBhYm91dDogZGF0YS5kZXNjcmlwdGlvbiB9KVxuICAgIC50aGVuKCgpID0+IHtcbiAgICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKGRhdGEpO1xuICAgIH0pO1xufVxuXG5mdW5jdGlvbiBoYW5kbGVQbGFjZUNyZWF0ZUZvcm0oZGF0YSkge1xuICBjb25zdCBjYXJkRGF0YSA9IHtcbiAgICBuYW1lOiBkYXRhLnRpdGxlLFxuICAgIGxpbms6IGRhdGEubGluayxcbiAgfTtcblxuICByZXR1cm4gYXBpLmNyZWF0ZUNhcmQoY2FyZERhdGEpLnRoZW4oKGNhcmQpID0+IHtcbiAgICBjb25zdCBjYXJkRWxlbWVudCA9IGNyZWF0ZUNhcmQoY2FyZCk7XG4gICAgY2FyZFNlY3Rpb24uYWRkSXRlbShjYXJkRWxlbWVudCk7XG4gICAgcGxhY2VDcmVhdGVGb3JtVmFsaWRhdG9yLmRpc2FibGVTdWJtaXQoKTtcbiAgfSk7XG59XG5cbnByb2ZpbGVBZGRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGZ1bmN0aW9uICgpIHtcbiAgcGxhY2VDcmVhdGVQb3B1cC5vcGVuKCk7XG59KTtcblxuLyogRnVuY3Rpb25zICovXG5cbmZ1bmN0aW9uIGhhbmRsZUF2YXRhclVwZGF0ZSh7IGxpbmsgfSkge1xuICByZXR1cm4gYXBpLnVwZGF0ZUF2YXRhcih7IGF2YXRhcjogbGluayB9KS50aGVuKChyZXMpID0+IHtcbiAgICB1cGRhdGVBdmF0YXJGb3JtVmFsaWRhdG9yLmRpc2FibGVTdWJtaXQoKTtcbiAgICB1c2VySW5mby5zZXRVc2VySW5mbyh7XG4gICAgICB0aXRsZTogcmVzLm5hbWUsXG4gICAgICBkZXNjcmlwdGlvbjogcmVzLmFib3V0LFxuICAgICAgYXZhdGFyOiByZXMuYXZhdGFyLFxuICAgIH0pO1xuICB9KTtcbn1cblxuZnVuY3Rpb24gY2FyZExpa2VDbGljayhjYXJkSWQsIGlzTGlrZWQpIHtcbiAgaWYgKGlzTGlrZWQpIHtcbiAgICByZXR1cm4gYXBpLmxpa2VDYXJkKGNhcmRJZCk7XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIGFwaS51bmxpa2VDYXJkKGNhcmRJZCk7XG4gIH1cbn1cblxuZnVuY3Rpb24gY3JlYXRlQ2FyZChjYXJkRGF0YSkge1xuICBjb25zdCBjYXJkSW5mbyA9IG5ldyBDYXJkKFxuICAgIGNhcmREYXRhLFxuICAgIFwiI2NhcmRfX3RlbXBsYXRlXCIsXG4gICAgZnVuY3Rpb24gKCkge1xuICAgICAgb3Blblpvb21QaWN0dXJlKGNhcmREYXRhLmxpbmssIGNhcmREYXRhLm5hbWUpO1xuICAgIH0sXG4gICAgaGFuZGxlRGVsZXRlQ2FyZCxcbiAgICBjYXJkTGlrZUNsaWNrXG4gICk7XG4gIGNvbnN0IGNhcmRFbGVtZW50ID0gY2FyZEluZm8uZ2V0VmlldygpO1xuICByZXR1cm4gY2FyZEVsZW1lbnQ7XG59XG5mdW5jdGlvbiBoYW5kbGVEZWxldGVDYXJkKGNhcmQsIGNhcmRFbGVtZW50KSB7XG4gIHBvcHVwV2l0aENvbmZpcm0ub3BlbigpO1xuICBwb3B1cFdpdGhDb25maXJtLnNldFN1Ym1pdEFjdGlvbigoKSA9PiB7XG4gICAgcmV0dXJuIGFwaVxuICAgICAgLmRlbGV0ZUNhcmQoY2FyZC5faWQpXG4gICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgIGNhcmRFbGVtZW50LnJlbW92ZSgpO1xuXG4gICAgICAgIHBvcHVwV2l0aENvbmZpcm0uY2xvc2UoKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICBjb25zb2xlLmVycihgRXJyb3IgZGVsZXRpbmcgY2FyZDogJHtlcnJ9YCk7XG4gICAgICB9KTtcbiAgfSk7XG59XG5cbmZ1bmN0aW9uIG9wZW5ab29tUGljdHVyZShzcmMsIGFsdCkge1xuICBjb25zdCBkYXRhID0geyBuYW1lOiBhbHQsIGxpbms6IHNyYyB9O1xuXG4gIHBvcHVwV2l0aEltYWdlLm9wZW4oZGF0YSk7XG59XG5cbmNvbnN0IGFwaSA9IG5ldyBBcGkoe1xuICBiYXNlVXJsOiBcImh0dHBzOi8vYXJvdW5kLWFwaS5lbi50cmlwbGV0ZW4tc2VydmljZXMuY29tL3YxXCIsXG4gIGhlYWRlcnM6IHtcbiAgICBhdXRob3JpemF0aW9uOiBcIjkzYjY0MTY0LTc5OTItNDViZS1iYWQyLTFmOTA5OGYwZWMzMlwiLFxuICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICB9LFxufSk7XG5cbmFwaVxuICAuZ2V0VXNlckluZm8oKVxuICAudGhlbigodXNlckRhdGEpID0+IHtcbiAgICB1c2VySW5mby5zZXRVc2VySW5mbyh7XG4gICAgICB0aXRsZTogdXNlckRhdGEubmFtZSxcbiAgICAgIGRlc2NyaXB0aW9uOiB1c2VyRGF0YS5hYm91dCxcbiAgICAgIGF2YXRhcjogdXNlckRhdGEuYXZhdGFyLFxuICAgIH0pO1xuICB9KVxuICAuY2F0Y2goKGVycikgPT4ge1xuICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBmZXRjaGluZyB1c2VyIGluZm86XCIsIGVycik7XG4gIH0pO1xuXG5hcGlcbiAgLmdldEluaXRpYWxDYXJkcygpXG4gIC50aGVuKChjYXJkcykgPT4ge1xuICAgIGNhcmRTZWN0aW9uLnNldEl0ZW1zKGNhcmRzKTtcbiAgfSlcbiAgLmNhdGNoKChlcnIpID0+IHtcbiAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgZmV0Y2hpbmcgaW5pdGlhbCBjYXJkczpcIiwgZXJyKTtcbiAgfSk7XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBTZWN0aW9uIHtcbiAgY29uc3RydWN0b3IoeyByZW5kZXJlciB9LCBjb250YWluZXJTZWxlY3Rvcikge1xuICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7XG4gICAgdGhpcy5fY29udGFpbmVyU2VsZWN0b3IgPSBjb250YWluZXJTZWxlY3RvcjtcbiAgICB0aGlzLl9jb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHRoaXMuX2NvbnRhaW5lclNlbGVjdG9yKTtcbiAgfVxuXG4gIHJlbmRlckl0ZW1zKCkge1xuICAgIHRoaXMuX2l0ZW1zLmZvckVhY2goKGVsZW1lbnQpID0+IHtcbiAgICAgXG4gICAgICBjb25zdCBub2RlID0gdGhpcy5fcmVuZGVyZXIoZWxlbWVudCk7XG4gICAgICB0aGlzLmFkZEl0ZW0obm9kZSk7XG4gICAgfSk7XG4gIH1cbiAgYWRkSXRlbShub2RlKSB7XG4gICAgdGhpcy5fY29udGFpbmVyLnByZXBlbmQobm9kZSk7XG4gIH1cbiAgc2V0SXRlbXMoaXRlbXMpIHtcbiAgICB0aGlzLl9pdGVtcyA9IGl0ZW1zO1xuICAgIHRoaXMucmVuZGVySXRlbXMoKTtcbiAgfVxufVxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcihtb2RhbFNlbGVjdG9yKSB7XG4gICAgc3VwZXIobW9kYWxTZWxlY3Rvcik7XG4gICAgdGhpcy5faW1hZ2VNb2RhbFpvb20gPSB0aGlzLl9wb3BFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX3pvb21cIik7XG4gICAgdGhpcy5faW1hZ2VNb2RhbE5hbWUgPSB0aGlzLl9wb3BFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX25hbWVcIik7XG4gIH1cblxuICBvcGVuKGRhdGEpIHtcbiAgICB0aGlzLl9pbWFnZU1vZGFsTmFtZS50ZXh0Q29udGVudCA9IGRhdGEubmFtZTtcbiAgICB0aGlzLl9pbWFnZU1vZGFsWm9vbS5zcmMgPSBkYXRhLmxpbms7XG4gICAgdGhpcy5faW1hZ2VNb2RhbFpvb20uYWx0ID0gZGF0YS5uYW1lO1xuICAgIHN1cGVyLm9wZW4oKTtcbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgVXNlckluZm8ge1xuICBjb25zdHJ1Y3Rvcih7XG4gICAgcHJvZmlsZVRpdGxlU2VsZWN0b3IsXG4gICAgcHJvZmlsZURlc2NyaXB0aW9uU2VsZWN0b3IsXG4gICAgYXZhdGFyU2VsZWN0b3IsXG4gIH0pIHtcbiAgICB0aGlzLl9wcm9maWxlVGl0bGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHByb2ZpbGVUaXRsZVNlbGVjdG9yKTtcbiAgICB0aGlzLl9wcm9maWxlRGVzY3JpcHRpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgcHJvZmlsZURlc2NyaXB0aW9uU2VsZWN0b3JcbiAgICApO1xuICAgIHRoaXMuX2F2YXRhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYXZhdGFyU2VsZWN0b3IpO1xuICB9XG5cbiAgZ2V0VXNlckluZm8oKSB7XG4gICAgY29uc3QgdXNlckRhdGEgPSB7XG4gICAgICB0aXRsZTogdGhpcy5fcHJvZmlsZVRpdGxlLnRleHRDb250ZW50LFxuICAgICAgZGVzY3JpcHRpb246IHRoaXMuX3Byb2ZpbGVEZXNjcmlwdGlvbi50ZXh0Q29udGVudCxcbiAgICB9O1xuICAgIHJldHVybiB1c2VyRGF0YTtcbiAgfVxuICBzZXRVc2VySW5mbyh7IHRpdGxlLCBkZXNjcmlwdGlvbiwgYXZhdGFyIH0pIHtcbiAgICB0aGlzLl9wcm9maWxlVGl0bGUudGV4dENvbnRlbnQgPSB0aXRsZTtcbiAgICB0aGlzLl9wcm9maWxlRGVzY3JpcHRpb24udGV4dENvbnRlbnQgPSBkZXNjcmlwdGlvbjtcbiAgICBpZiAoYXZhdGFyKSB7XG4gICAgICB0aGlzLl9hdmF0YXIuc3R5bGUuYmFja2dyb3VuZEltYWdlID0gYHVybCgke2F2YXRhcn0pYDtcbiAgICB9XG4gIH1cbn1cbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cFwiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhDb25maXJtIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yLCBoYW5kbGVGb3JtU3VibWl0KSB7XG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XG4gICAgdGhpcy5faGFuZGxlU3VibWl0ID0gaGFuZGxlRm9ybVN1Ym1pdDtcbiAgICB0aGlzLl9idXR0b24gPSB0aGlzLl9wb3BFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2J1dHRvblwiKTtcbiAgfVxuXG4gIHNldFN1Ym1pdEFjdGlvbihmbikge1xuICAgIHRoaXMuX2hhbmRsZVN1Ym1pdCA9IGZuO1xuICB9XG5cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgICB0aGlzLl9idXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICB0aGlzLl9oYW5kbGVTdWJtaXQoKTtcbiAgICB9KTtcbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQXBpIHtcbiAgY29uc3RydWN0b3IoeyBoZWFkZXJzLCBiYXNlVXJsIH0pIHtcbiAgICB0aGlzLl9kZWZhdWx0SGVhZGVycyA9IGhlYWRlcnM7XG4gICAgdGhpcy5fYmFzZVVybCA9IGJhc2VVcmw7XG4gIH1cblxuICBnZXRJbml0aWFsQ2FyZHMoKSB7XG4gICAgcmV0dXJuIHRoaXMuaGFuZGxlUmVzcG9uc2UoXG4gICAgICBmZXRjaCh0aGlzLl9iYXNlVXJsICsgXCIvY2FyZHNcIiwgeyBoZWFkZXJzOiB0aGlzLl9kZWZhdWx0SGVhZGVycyB9KVxuICAgICk7XG4gIH1cblxuICBnZXRVc2VySW5mbygpIHtcbiAgICByZXR1cm4gdGhpcy5oYW5kbGVSZXNwb25zZShcbiAgICAgIGZldGNoKHRoaXMuX2Jhc2VVcmwgKyBcIi91c2Vycy9tZVwiLCB7IGhlYWRlcnM6IHRoaXMuX2RlZmF1bHRIZWFkZXJzIH0pXG4gICAgKTtcbiAgfVxuXG4gIHVwZGF0ZVVzZXJJbmZvKHVzZXJJbmZvKSB7XG4gICAgcmV0dXJuIHRoaXMuaGFuZGxlUmVzcG9uc2UoXG4gICAgICBmZXRjaCh0aGlzLl9iYXNlVXJsICsgXCIvdXNlcnMvbWVcIiwge1xuICAgICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcbiAgICAgICAgaGVhZGVyczogdGhpcy5fZGVmYXVsdEhlYWRlcnMsXG4gICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHVzZXJJbmZvKSxcbiAgICAgIH0pXG4gICAgKTtcbiAgfVxuXG4gIGNyZWF0ZUNhcmQoY3JlYXRlQ2FyZEluZm8pIHtcbiAgICByZXR1cm4gdGhpcy5oYW5kbGVSZXNwb25zZShcbiAgICAgIGZldGNoKHRoaXMuX2Jhc2VVcmwgKyBcIi9jYXJkc1wiLCB7XG4gICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICAgIGhlYWRlcnM6IHRoaXMuX2RlZmF1bHRIZWFkZXJzLFxuICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeShjcmVhdGVDYXJkSW5mbyksXG4gICAgICB9KVxuICAgICk7XG4gIH1cblxuICBkZWxldGVDYXJkKGNhcmRJZCkge1xuICAgIHJldHVybiB0aGlzLmhhbmRsZVJlc3BvbnNlKFxuICAgICAgZmV0Y2godGhpcy5fYmFzZVVybCArIFwiL2NhcmRzL1wiICsgY2FyZElkLCB7XG4gICAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcbiAgICAgICAgaGVhZGVyczogdGhpcy5fZGVmYXVsdEhlYWRlcnMsXG4gICAgICB9KVxuICAgICk7XG4gIH1cblxuICBsaWtlQ2FyZChjYXJkSWQpIHtcbiAgICByZXR1cm4gdGhpcy5oYW5kbGVSZXNwb25zZShcbiAgICAgIGZldGNoKHRoaXMuX2Jhc2VVcmwgKyBcIi9jYXJkcy9cIiArIGNhcmRJZCArIFwiL2xpa2VzXCIsIHtcbiAgICAgICAgbWV0aG9kOiBcIlBVVFwiLFxuICAgICAgICBoZWFkZXJzOiB0aGlzLl9kZWZhdWx0SGVhZGVycyxcbiAgICAgIH0pXG4gICAgKTtcbiAgfVxuXG4gIHVubGlrZUNhcmQoY2FyZElkKSB7XG4gICAgcmV0dXJuIHRoaXMuaGFuZGxlUmVzcG9uc2UoXG4gICAgICBmZXRjaCh0aGlzLl9iYXNlVXJsICsgXCIvY2FyZHMvXCIgKyBjYXJkSWQgKyBcIi9saWtlc1wiLCB7XG4gICAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcbiAgICAgICAgaGVhZGVyczogdGhpcy5fZGVmYXVsdEhlYWRlcnMsXG4gICAgICB9KVxuICAgICk7XG4gIH1cblxuICB1cGRhdGVBdmF0YXIoYXZhdGFyKSB7XG4gICAgcmV0dXJuIHRoaXMuaGFuZGxlUmVzcG9uc2UoXG4gICAgICBmZXRjaCh0aGlzLl9iYXNlVXJsICsgXCIvdXNlcnMvbWUvYXZhdGFyXCIsIHtcbiAgICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXG4gICAgICAgIGhlYWRlcnM6IHRoaXMuX2RlZmF1bHRIZWFkZXJzLFxuICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeShhdmF0YXIpLFxuICAgICAgfSlcbiAgICApO1xuICB9XG5cbiAgaGFuZGxlUmVzcG9uc2UocmVxdWVzdCkge1xuICAgIHJldHVybiByZXF1ZXN0XG4gICAgICAudGhlbigocmVzKSA9PiB7XG4gICAgICAgIGlmIChyZXMub2spIHtcbiAgICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xuICAgICAgICB0aHJvdyBlcnI7XG4gICAgICB9KTtcbiAgfVxuXG4gIGxvYWRBbGwoKSB7XG4gICAgcmV0dXJuIFByb21pc2UuYWxsKHRoaXMuZ2V0SW5pdGlhbENhcmRzKCksIHRoaXMuZ2V0VXNlckluZm8oKSk7XG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJjb25zdHJ1Y3RvciIsImNvbmZpZyIsImZvcm1FbGUiLCJ0aGlzIiwiX2Zvcm1TZWxlY3RvciIsImZvcm1TZWxlY3RvciIsIl9pbnB1dFNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsIl9zdWJtaXRCdXR0b25TZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiX2luYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiX2lucHV0RXJyb3JDbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsIl9lcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsIl9pbnB1dEVsZXMiLCJxdWVyeVNlbGVjdG9yQWxsIiwiX3N1Ym1pdEJ1dHRvbiIsInF1ZXJ5U2VsZWN0b3IiLCJfc2hvd0lucHV0RXJyb3IiLCJpbnB1dEVsZSIsImVycm9yTWVzc2FnZUVsZSIsImlkIiwidGV4dENvbnRlbnQiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsImNsYXNzTGlzdCIsImFkZCIsIl9oaWRlSW5wdXRFcnJvciIsInJlbW92ZSIsIl9jaGVja0lucHV0VmFsaWRpdHkiLCJ2YWxpZGl0eSIsInZhbGlkIiwiX3RvZ2dsZUJ1dHRvblN0YXRlIiwic29tZSIsImRpc2FibGVTdWJtaXQiLCJlbmFibGVTdWJtaXQiLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJmb3JFYWNoIiwiYWRkRXZlbnRMaXN0ZW5lciIsImVuYWJsZVZhbGlkYXRpb24iLCJlIiwicHJldmVudERlZmF1bHQiLCJkaXNhYmxlZCIsIl9yZWYiLCJjYXJkU2VsZWN0b3IiLCJjYXJkSW1hZ2VDbGlja0hhbmRsZXIiLCJoYW5kbGVEZWxldGUiLCJjYXJkTGlrZUNsaWNrIiwibmFtZSIsImxpbmsiLCJfaWQiLCJpc0xpa2VkIiwiX25hbWUiLCJfbGluayIsIl9pc0xpa2VkIiwiX2NhcmRTZWxlY3RvciIsIl9jYXJkSW1hZ2VDbGlja0hhbmRsZXIiLCJfaGFuZGxlRGVsZXRlIiwiX2hhbmRsZUNhcmRMaWtlQ2xpY2siLCJfY2FyZEVsZW1lbnQiLCJfZ2V0VGVtcGxhdGUiLCJfbGlrZUJ1dHRvbiIsIl9yZW1vdmVCdXR0b24iLCJfY2FyZEltYWdlRWxlbWVudCIsIl9iaW5kSW5mbyIsImRvY3VtZW50IiwiY29udGVudCIsImNsb25lTm9kZSIsImNhcmRUaXRsZUVsZW1lbnQiLCJzcmMiLCJhbHQiLCJ1cGRhdGVMaWtlU3RhdGUiLCJhY3RpdmVDbGFzcyIsImlzQ3VycmVudGx5TGlrZWQiLCJ0aGVuIiwiY2F0Y2giLCJlcnIiLCJjb25zb2xlIiwiZXJyb3IiLCJnZXRWaWV3IiwiUG9wdXAiLCJwb3B1cFNlbGVjdG9yIiwiX3BvcEVsZW1lbnQiLCJfcG9wdXBDbG9zZUJ1dHRvbiIsIl9oYW5kbGVNb2RhbENsb3NlIiwiYmluZCIsIl9oYW5kbGVFc2NDbG9zZSIsIm9wZW4iLCJjbG9zZSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJldnQiLCJrZXkiLCJzZXRFdmVudExpc3RlbmVycyIsInN0b3BQcm9wYWdhdGlvbiIsIlBvcHVwV2l0aEZvcm0iLCJoYW5kbGVGb3JtU3VibWl0Iiwic3VwZXIiLCJfcG9wdXBGb3JtIiwiX2lucHV0TGlzdCIsIl9oYW5kbGVGb3JtU3VibWl0IiwiX2dldElucHV0VmFsdWVzIiwiX3N1Ym1pdEJ1dHRvblRleHQiLCJkYXRhIiwiaW5wdXQiLCJ2YWx1ZSIsIl9jbGVhcklucHV0cyIsInJlc2V0IiwicmVuZGVyTG9hZGluZyIsImlzTG9hZGluZyIsImxvZyIsImV2ZW50IiwiZmluYWxseSIsInNldFN1Ym1pdEhhbmRsZXIiLCJoYW5kbGVyIiwidmFsaWRhdGlvbkNvbmZpZyIsInByb2ZpbGVFZGl0QnV0dG9uIiwicHJvZmlsZUVkaXRNb2RhbCIsInByb2ZpbGVUaXRsZUlucHV0IiwicHJvZmlsZURlc2NyaXB0aW9uSW5wdXQiLCJwcm9maWxlRWRpdEZvcm0iLCJmb3JtcyIsInByb2ZpbGVBZGRCdXR0b24iLCJwbGFjZUNyZWF0ZUZvcm0iLCJhdmF0YXJFZGl0QnV0dG9uIiwidXBkYXRlQXZhdGFyRm9ybSIsImNhcmRTZWN0aW9uIiwiY29udGFpbmVyU2VsZWN0b3IiLCJyZW5kZXJlciIsIl9yZW5kZXJlciIsIl9jb250YWluZXJTZWxlY3RvciIsIl9jb250YWluZXIiLCJyZW5kZXJJdGVtcyIsIl9pdGVtcyIsImVsZW1lbnQiLCJub2RlIiwiYWRkSXRlbSIsInByZXBlbmQiLCJzZXRJdGVtcyIsIml0ZW1zIiwiY3JlYXRlQ2FyZCIsInBvcHVwV2l0aEltYWdlIiwibW9kYWxTZWxlY3RvciIsIl9pbWFnZU1vZGFsWm9vbSIsIl9pbWFnZU1vZGFsTmFtZSIsInVzZXJJbmZvIiwicHJvZmlsZVRpdGxlU2VsZWN0b3IiLCJwcm9maWxlRGVzY3JpcHRpb25TZWxlY3RvciIsImF2YXRhclNlbGVjdG9yIiwiX3Byb2ZpbGVUaXRsZSIsIl9wcm9maWxlRGVzY3JpcHRpb24iLCJfYXZhdGFyIiwiZ2V0VXNlckluZm8iLCJ0aXRsZSIsImRlc2NyaXB0aW9uIiwic2V0VXNlckluZm8iLCJfcmVmMiIsImF2YXRhciIsInN0eWxlIiwiYmFja2dyb3VuZEltYWdlIiwicHJvZmlsZUVkaXRQb3B1cCIsImFwaSIsInVwZGF0ZVVzZXJJbmZvIiwiYWJvdXQiLCJwbGFjZUNyZWF0ZVBvcHVwIiwiY2FyZERhdGEiLCJjYXJkIiwiY2FyZEVsZW1lbnQiLCJwbGFjZUNyZWF0ZUZvcm1WYWxpZGF0b3IiLCJzZXRBdmF0YXJQb3B1cCIsInVwZGF0ZUF2YXRhciIsInJlcyIsInVwZGF0ZUF2YXRhckZvcm1WYWxpZGF0b3IiLCJGb3JtVmFsaWRhdG9yIiwicG9wdXBXaXRoQ29uZmlybSIsIl9oYW5kbGVTdWJtaXQiLCJfYnV0dG9uIiwic2V0U3VibWl0QWN0aW9uIiwiZm4iLCJwcm9maWxlRWRpdEZvcm1WYWxpZGF0b3IiLCJjYXJkSWQiLCJsaWtlQ2FyZCIsInVubGlrZUNhcmQiLCJDYXJkIiwib3Blblpvb21QaWN0dXJlIiwiaGFuZGxlRGVsZXRlQ2FyZCIsImRlbGV0ZUNhcmQiLCJ1c2VyRGF0YSIsImhlYWRlcnMiLCJiYXNlVXJsIiwiX2RlZmF1bHRIZWFkZXJzIiwiX2Jhc2VVcmwiLCJnZXRJbml0aWFsQ2FyZHMiLCJoYW5kbGVSZXNwb25zZSIsImZldGNoIiwibWV0aG9kIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJjcmVhdGVDYXJkSW5mbyIsInJlcXVlc3QiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwibG9hZEFsbCIsImFsbCIsImF1dGhvcml6YXRpb24iLCJjYXJkcyJdLCJzb3VyY2VSb290IjoiIn0=